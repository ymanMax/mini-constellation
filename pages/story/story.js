Page({
  data: {
    searchKeyword: '',
    stars: [],
    filteredStars: []
  },

  onLoad() {
    this.loadStarStories();
  },

  // 加载星座故事数据
  loadStarStories() {
    // Mock数据
    const starStories = [
      {
        id: 1,
        name: '白羊座',
        icon: 'icon-baiyang',
        date: '3月21日-4月19日',
        desc: '白羊座的传说讲述了金羊解救王子公主的故事...',
        legend: '在古希腊神话中，白羊座是一只拥有金毛的神羊。它受宙斯之命，解救了正在被追杀的王子菲利塞斯和公主黑伦。神羊背着他们飞跃海洋，最后在抵达安全之地时，神羊因劳累过度而死。宙斯为了纪念这只勇敢的神羊，将它升上天空，成为白羊座。',
        culture: '白羊座在占星学中代表着新生、勇气和冒险精神。它是十二星座中的第一个星座，象征着春天的开始和新的开始。在不同文化中，白羊座通常被视为积极、主动和具有领导才能的象征。'
      },
      {
        id: 2,
        name: '金牛座',
        icon: 'icon-jinniu',
        date: '4月20日-5月20日',
        desc: '金牛座的传说与宙斯化身公牛追求欧罗巴有关...',
        legend: '金牛座的传说源自宙斯对腓尼基公主欧罗巴的爱慕。为了接近欧罗巴，宙斯化身成一头美丽的白色公牛，混进了公主的牛群中。公主被这头温驯又美丽的公牛吸引，最终骑上了它的背。宙斯趁机带着公主飞跃海洋，来到了克里特岛。为了纪念这段经历，宙斯将这头公牛升上天空，成为金牛座。',
        culture: '金牛座在占星学中代表着稳定、务实和物质享受。它象征着春天的繁荣和丰收。金牛座通常被视为可靠、耐心和具有商业头脑的象征。在不同文化中，金牛也常与财富、美食和舒适的生活联系在一起。'
      },
      {
        id: 3,
        name: '双子座',
        icon: 'icon-shuangzi',
        date: '5月21日-6月21日',
        desc: '双子座的传说讲述了卡斯托尔和波吕克斯这对孪生兄弟的故事...',
        legend: '双子座的传说源自希腊神话中的孪生兄弟卡斯托尔和波吕克斯。他们是斯巴达王后勒达所生，卡斯托尔是凡人，而波吕克斯是神。兄弟俩形影不离，一起经历了许多冒险。后来卡斯托尔在一次战斗中死去，波吕克斯不愿独自活在世上，请求宙斯让他们兄弟永远在一起。宙斯被他们的兄弟情谊感动，将他们升上天空，成为双子座。',
        culture: '双子座在占星学中代表着沟通、变化和好奇心。它象征着夏天的开始和思维的活跃。双子座通常被视为聪明、灵活和善于社交的象征。在不同文化中，双子也常与信息传递、旅行和多重性格联系在一起。'
      },
      {
        id: 4,
        name: '巨蟹座',
        icon: 'icon-juxie',
        date: '6月22日-7月22日',
        desc: '巨蟹座的传说与赫拉克勒斯大战九头蛇时出现的螃蟹有关...',
        legend: '巨蟹座的传说源自赫拉克勒斯的十二项任务之一。当赫拉克勒斯与九头蛇许德拉战斗时，天后赫拉为了阻碍赫拉克勒斯，派了一只巨大的螃蟹去夹他的脚。虽然螃蟹最终被赫拉克勒斯踩死，但赫拉为了纪念它的忠诚，将它升上天空，成为巨蟹座。',
        culture: '巨蟹座在占星学中代表着家庭、情感和保护。它象征着夏天的温暖和母性的关怀。巨蟹座通常被视为温柔、敏感和具有强烈家庭观念的象征。在不同文化中，巨蟹也常与家园、童年和情感安全感联系在一起。'
      },
      {
        id: 5,
        name: '狮子座',
        icon: 'icon-shizi',
        date: '7月23日-8月22日',
        desc: '狮子座的传说讲述了赫拉克勒斯杀死涅墨亚狮子的故事...',
        legend: '狮子座的传说源自赫拉克勒斯的第一项任务。他被要求杀死涅墨亚狮子，这是一只非常凶猛的野兽，它的皮毛刀枪不入。赫拉克勒斯经过一番激烈的战斗，最终用自己的双手掐死了狮子。为了纪念这一壮举，宙斯将狮子的形象升上天空，成为狮子座。',
        culture: '狮子座在占星学中代表着权力、自信和领导力。它象征着夏天的炎热和太阳的光芒。狮子座通常被视为勇敢、慷慨和具有王者风范的象征。在不同文化中，狮子也常与权威、荣耀和保护联系在一起。'
      },
      {
        id: 6,
        name: '处女座',
        icon: 'icon-chunv',
        date: '8月23日-9月22日',
        desc: '处女座的传说与农业女神德墨忒尔的女儿珀耳塞福涅有关...',
        legend: '处女座的传说源自希腊神话中的农业女神德墨忒尔和她的女儿珀耳塞福涅。珀耳塞福涅被冥王哈迪斯劫走，带到了冥界。德墨忒尔为了寻找女儿，四处流浪，导致大地荒芜。最终宙斯出面调解，让珀耳塞福涅每年有六个月的时间留在冥界，另外六个月则回到人间与母亲团聚。当珀耳塞福涅回到人间时，德墨忒尔便让大地恢复生机。处女座被认为是珀耳塞福涅的化身，象征着纯洁和丰收。',
        culture: '处女座在占星学中代表着完美、分析和服务。它象征着秋天的开始和收获的季节。处女座通常被视为细心、勤奋和具有服务精神的象征。在不同文化中，处女也常与纯洁、健康和工作效率联系在一起。'
      },
      {
        id: 7,
        name: '天秤座',
        icon: 'icon-tiancheng',
        date: '9月23日-10月23日',
        desc: '天秤座的传说与正义女神忒弥斯和她的秤有关...',
        legend: '天秤座的传说源自希腊神话中的正义女神忒弥斯。忒弥斯手持天平，负责裁决人间的善恶是非。她的天平能够准确地衡量出每个人的行为善恶，并据此做出公正的判决。后来宙斯将忒弥斯的天平升上天空，成为天秤座，象征着正义和公平。',
        culture: '天秤座在占星学中代表着平衡、和谐和公正。它象征着秋天的平衡和昼夜平分。天秤座通常被视为优雅、公正和具有外交才能的象征。在不同文化中，天秤也常与和平、合作和美学联系在一起。'
      },
      {
        id: 8,
        name: '天蝎座',
        icon: 'icon-tianxie',
        date: '10月24日-11月22日',
        desc: '天蝎座的传说与猎户座奥赖翁和蝎子的故事有关...',
        legend: '天蝎座的传说源自希腊神话中的猎户座奥赖翁。奥赖翁是一位非常勇敢的猎人，他甚至夸口说自己能够杀死世上所有的野兽。这激怒了大地女神盖亚，她派了一只巨大的蝎子去杀死奥赖翁。在一场激烈的战斗后，蝎子最终成功地杀死了奥赖翁，但自己也因此而死。为了纪念这场战斗，宙斯将蝎子的形象升上天空，成为天蝎座，而奥赖翁则成为猎户座。有趣的是，在天空中，当猎户座升起时，天蝎座便会落下，仿佛它们仍然在互相躲避。',
        culture: '天蝎座在占星学中代表着深刻、蜕变和重生。它象征着秋天的结束和生命的轮回。天蝎座通常被视为神秘、热情和具有强烈洞察力的象征。在不同文化中，天蝎也常与 transformation、秘密和深刻的情感联系在一起。'
      },
      {
        id: 9,
        name: '射手座',
        icon: 'icon-sheshou',
        date: '11月23日-12月21日',
        desc: '射手座的传说与半人马喀戎有关...',
        legend: '射手座的传说源自希腊神话中的半人马喀戎。喀戎是一位非常智慧和善良的半人马，他精通医术、音乐、射箭和预言等各种技艺。他曾经是许多希腊英雄的老师，包括赫拉克勒斯、阿喀琉斯和伊阿宋等。后来喀戎在一次意外中被赫拉克勒斯的毒箭射中，虽然他拥有不死之身，但却要永远忍受毒箭带来的痛苦。为了摆脱这种痛苦，喀戎自愿将自己的不死之身让给了普罗米修斯，而自己则选择了死亡。宙斯为了纪念喀戎的智慧和善良，将他升上天空，成为射手座，他手中的弓箭永远指向远方，象征着对知识和真理的追求。',
        culture: '射手座在占星学中代表着冒险、自由和追求真理。它象征着冬天的开始和对未知的探索。射手座通常被视为乐观、开朗和具有哲学思想的象征。在不同文化中，射手也常与旅行、教育和精神追求联系在一起。'
      },
      {
        id: 10,
        name: '摩羯座',
        icon: 'icon-mojie',
        date: '12月22日-1月19日',
        desc: '摩羯座的传说与牧神潘有关...',
        legend: '摩羯座的传说源自希腊神话中的牧神潘。潘是一位半人半羊的神，他负责掌管山林、畜牧和狩猎。潘非常喜欢音乐，他经常吹着自己制作的芦笛在山林中漫步，他的音乐能够吸引所有的动物前来聆听。有一次，潘参加了众神的聚会，他吹起了美妙的芦笛，所有的神都被他的音乐所陶醉。为了纪念潘的音乐才华，宙斯将他的形象升上天空，成为摩羯座。不过，摩羯座的形象并不是完整的半人半羊，而是只有上半身是羊，下半身是鱼，这是因为在一次众神被提坦巨人追杀时，潘为了逃跑，跳进了一条河里，结果他的下半身变成了鱼，而上半身则保持了羊的样子。',
        culture: '摩羯座在占星学中代表着责任、成就和实际主义。它象征着冬天的深处和对目标的执着追求。摩羯座通常被视为稳重、勤奋和具有强烈责任感的象征。在不同文化中，摩羯也常与事业、成功和社会地位联系在一起。'
      },
      {
        id: 11,
        name: '水瓶座',
        icon: 'icon-shuiping',
        date: '1月20日-2月18日',
        desc: '水瓶座的传说与特洛伊王子甘尼美德有关...',
        legend: '水瓶座的传说源自希腊神话中的特洛伊王子甘尼美德。甘尼美德是一位非常英俊的王子，他的美貌甚至吸引了众神之王宙斯的注意。宙斯为了得到甘尼美德，化身成一只巨大的老鹰，将甘尼美德从特洛伊城掳走，带到了奥林匹斯山上。宙斯让甘尼美德担任自己的侍酒童，负责为众神斟酒。甘尼美德非常聪明和勤快，他很快就赢得了所有神的喜爱。为了纪念甘尼美德，宙斯将他的形象升上天空，成为水瓶座，他手中的水瓶永远不停地倒出水来，象征着智慧和知识的源源不断。',
        culture: '水瓶座在占星学中代表着创新、独立和人道主义。它象征着冬天的结束和春天的临近。水瓶座通常被视为聪明、独特和具有社会责任感的象征。在不同文化中，水瓶也常与科学、技术和社会变革联系在一起。'
      },
      {
        id: 12,
        name: '双鱼座',
        icon: 'icon-shuangyu',
        date: '2月19日-3月20日',
        desc: '双鱼座的传说与爱神阿芙洛狄忒和她的儿子厄洛斯有关...',
        legend: '双鱼座的传说源自希腊神话中的爱神阿芙洛狄忒和她的儿子厄洛斯。有一次，阿芙洛狄忒和厄洛斯在河边散步，突然遇到了可怕的提坦巨人堤丰。堤丰是一位非常强大和凶恶的巨人，他曾经差点推翻了宙斯的统治。为了躲避堤丰的追杀，阿芙洛狄忒和厄洛斯跳进了河里，变成了两条鱼。他们用一根丝带将彼此的尾巴绑在一起，这样他们就不会被水流冲散。后来宙斯为了纪念阿芙洛狄忒和厄洛斯的勇气和爱情，将他们变成的两条鱼升上天空，成为双鱼座。',
        culture: '双鱼座在占星学中代表着梦想、情感和同情心。它象征着春天的开始和生命的复苏。双鱼座通常被视为温柔、善良和具有强烈想象力的象征。在不同文化中，双鱼也常与艺术、音乐和精神世界联系在一起。'
      }
    ];

    this.setData({
      stars: starStories,
      filteredStars: starStories
    });
  },

  // 搜索输入
  onSearchInput(e) {
    const keyword = e.detail.value.trim();
    this.setData({
      searchKeyword: keyword
    });
    this.filterStars(keyword);
  },

  // 清除搜索
  onClearSearch() {
    this.setData({
      searchKeyword: ''
    });
    this.filterStars('');
  },

  // 筛选星座
  filterStars(keyword) {
    if (!keyword) {
      this.setData({
        filteredStars: this.data.stars
      });
      return;
    }

    const filtered = this.data.stars.filter(star => {
      return star.name.includes(keyword) ||
             star.desc.includes(keyword) ||
             star.date.includes(keyword);
    });

    this.setData({
      filteredStars: filtered
    });
  },

  // 跳转到星座详情页
  goToStarDetail(e) {
    const starId = e.currentTarget.dataset.id;
    const star = this.data.stars.find(s => s.id === starId);

    wx.navigateTo({
      url: `/pages/story/detail/detail?starData=${encodeURIComponent(JSON.stringify(star))}`
    });
  }
});